torch

torch.Tensor

A torch.Tensor is a multi-dimensional matrix containing elements of a
single data type. Please see dtype-doc for more details about dtype
support.

Initializing and basic operations

A tensor can be constructed from a Python list or sequence using the
torch.tensor constructor:

    >>> torch.tensor([[1., -1.], [1., -1.]])
    tensor([[ 1.0000, -1.0000],
            [ 1.0000, -1.0000]])
    >>> torch.tensor(np.array([[1, 2, 3], [4, 5, 6]]))
    tensor([[ 1,  2,  3],
            [ 4,  5,  6]])

Warning

torch.tensor always copies data. If you have a Tensor data and just want
to change its requires_grad flag, use ~torch.Tensor.requires_grad_ or
~torch.Tensor.detach to avoid a copy. If you have a numpy array and want
to avoid a copy, use torch.as_tensor.

A tensor of specific data type can be constructed by passing a
torch.dtype and/or a torch.device to a constructor or tensor creation
op:

    >>> torch.zeros([2, 4], dtype=torch.int32)
    tensor([[ 0,  0,  0,  0],
            [ 0,  0,  0,  0]], dtype=torch.int32)
    >>> cuda0 = torch.device('cuda:0')
    >>> torch.ones([2, 4], dtype=torch.float64, device=cuda0)
    tensor([[ 1.0000,  1.0000,  1.0000,  1.0000],
            [ 1.0000,  1.0000,  1.0000,  1.0000]], dtype=torch.float64, device='cuda:0')

For more information about building Tensors, see tensor-creation-ops

The contents of a tensor can be accessed and modified using Python's
indexing and slicing notation:

    >>> x = torch.tensor([[1, 2, 3], [4, 5, 6]])
    >>> print(x[1][2])
    tensor(6)
    >>> x[0][1] = 8
    >>> print(x)
    tensor([[ 1,  8,  3],
            [ 4,  5,  6]])

Use torch.Tensor.item to get a Python number from a tensor containing a
single value:

    >>> x = torch.tensor([[1]])
    >>> x
    tensor([[ 1]])
    >>> x.item()
    1
    >>> x = torch.tensor(2.5)
    >>> x
    tensor(2.5000)
    >>> x.item()
    2.5

For more information about indexing, see indexing-slicing-joining

A tensor can be created with requires_grad=True so that torch.autograd
records operations on them for automatic differentiation.

    >>> x = torch.tensor([[1., -1.], [1., 1.]], requires_grad=True)
    >>> out = x.pow(2).sum()
    >>> out.backward()
    >>> x.grad
    tensor([[ 2.0000, -2.0000],
            [ 2.0000,  2.0000]])

Each tensor has an associated torch.Storage, which holds its data. The
tensor class also provides multi-dimensional, strided view of a storage
and defines numeric operations on it.

Note

For more information on tensor views, see tensor-view-doc.

Note

For more information on the torch.dtype, torch.device, and torch.layout
attributes of a torch.Tensor, see tensor-attributes-doc.

Note

Methods which mutate a tensor are marked with an underscore suffix. For
example, torch.FloatTensor.abs_ computes the absolute value in-place and
returns the modified tensor, while torch.FloatTensor.abs computes the
result in a new tensor.

Note

To change an existing tensor's torch.device and/or torch.dtype, consider
using ~torch.Tensor.to method on the tensor.

Warning

Current implementation of torch.Tensor introduces memory overhead, thus
it might lead to unexpectedly high memory usage in the applications with
many tiny tensors. If this is your case, consider using one large
structure.

Tensor class reference

There are a few main ways to create a tensor, depending on your use
case.

- To create a tensor with pre-existing data, use torch.tensor.
- To create a tensor with specific size, use torch.* tensor creation ops
  (see tensor-creation-ops).
- To create a tensor with the same size (and similar types) as another
  tensor, use torch.*_like tensor creation ops (see
  tensor-creation-ops).
- To create a tensor with similar type but different size as another
  tensor, use tensor.new_* creation ops.
- There is a legacy constructor torch.Tensor whose use is discouraged.
  Use torch.tensor instead.

Tensor.__init__(self, data)

This constructor is deprecated, we recommend using torch.tensor instead.
What this constructor does depends on the type of data.

- If data is a Tensor, returns an alias to the original Tensor. Unlike
  torch.tensor, this tracks autograd and will propagate gradients to the
  original Tensor. device kwarg is not supported for this data type.
- If data is a sequence or nested sequence, create a tensor of the
  default dtype (typically torch.float32) whose data is the values in
  the sequences, performing coercions if necessary. Notably, this
  differs from torch.tensor in that this constructor will always
  construct a float tensor, even if the inputs are all integers.
- If data is a torch.Size, returns an empty tensor of that size.

This constructor does not support explicitly specifying dtype or device
of the returned tensor. We recommend using torch.tensor which provides
this functionality.

Args:

    data (array_like): The tensor to construct from.

Keyword args:

    

    device (torch.device, optional): the desired device of returned tensor.

        Default: if None, same torch.device as this tensor.

Tensor.T

Tensor.H

Tensor.mT

Tensor.mH

Tensor.new_tensor Tensor.new_full Tensor.new_empty Tensor.new_ones
Tensor.new_zeros

Tensor.is_cuda Tensor.is_quantized Tensor.is_meta Tensor.device
Tensor.grad Tensor.ndim Tensor.real Tensor.imag Tensor.nbytes
Tensor.itemsize

Tensor.abs Tensor.abs Tensor.absolute Tensor.absolute Tensor.acos
Tensor.acos Tensor.arccos Tensor.arccos Tensor.add Tensor.add
Tensor.addbmm Tensor.addbmm Tensor.addcdiv Tensor.addcdiv Tensor.addcmul
Tensor.addcmul Tensor.addmm Tensor.addmm Tensor.sspaddmm Tensor.addmv
Tensor.addmv Tensor.addr Tensor.addr Tensor.adjoint Tensor.allclose
Tensor.amax Tensor.amin Tensor.aminmax Tensor.angle Tensor.apply
Tensor.argmax Tensor.argmin Tensor.argsort Tensor.argwhere Tensor.asin
Tensor.asin Tensor.arcsin Tensor.arcsin Tensor.as_strided Tensor.atan
Tensor.atan Tensor.arctan Tensor.arctan Tensor.atan2 Tensor.atan2
Tensor.arctan2 Tensor.arctan2 Tensor.all Tensor.any Tensor.backward
Tensor.baddbmm Tensor.baddbmm Tensor.bernoulli Tensor.bernoulli
Tensor.bfloat16 Tensor.bincount Tensor.bitwise_not Tensor.bitwise_not
Tensor.bitwise_and Tensor.bitwise_and Tensor.bitwise_or
Tensor.bitwise_or Tensor.bitwise_xor Tensor.bitwise_xor
Tensor.bitwise_left_shift Tensor.bitwise_left_shift
Tensor.bitwise_right_shift Tensor.bitwise_right_shift Tensor.bmm
Tensor.bool Tensor.byte Tensor.broadcast_to Tensor.cauchy Tensor.ceil
Tensor.ceil Tensor.char Tensor.cholesky Tensor.cholesky_inverse
Tensor.cholesky_solve Tensor.chunk Tensor.clamp Tensor.clamp Tensor.clip
Tensor.clip Tensor.clone Tensor.contiguous Tensor.copy Tensor.conj
Tensor.conj_physical Tensor.conj_physical Tensor.resolve_conj
Tensor.resolve_neg Tensor.copysign Tensor.copysign Tensor.cos Tensor.cos
Tensor.cosh Tensor.cosh Tensor.corrcoef Tensor.count_nonzero Tensor.cov
Tensor.acosh Tensor.acosh Tensor.arccosh Tensor.arccosh Tensor.cpu
Tensor.cross Tensor.cuda Tensor.logcumsumexp Tensor.cummax Tensor.cummin
Tensor.cumprod Tensor.cumprod Tensor.cumsum Tensor.cumsum Tensor.chalf
Tensor.cfloat Tensor.cdouble Tensor.data_ptr Tensor.deg2rad
Tensor.dequantize Tensor.det Tensor.dense_dim Tensor.detach
Tensor.detach Tensor.diag Tensor.diag_embed Tensor.diagflat
Tensor.diagonal Tensor.diagonal_scatter Tensor.fill_diagonal Tensor.fmax
Tensor.fmin Tensor.diff Tensor.digamma Tensor.digamma Tensor.dim
Tensor.dim_order Tensor.dist Tensor.div Tensor.div Tensor.divide
Tensor.divide Tensor.dot Tensor.double Tensor.dsplit Tensor.element_size
Tensor.eq Tensor.eq Tensor.equal Tensor.erf Tensor.erf Tensor.erfc
Tensor.erfc Tensor.erfinv Tensor.erfinv Tensor.exp Tensor.exp
Tensor.expm1 Tensor.expm1 Tensor.expand Tensor.expand_as
Tensor.exponential Tensor.fix Tensor.fix Tensor.fill Tensor.flatten
Tensor.flip Tensor.fliplr Tensor.flipud Tensor.float Tensor.float_power
Tensor.float_power Tensor.floor Tensor.floor Tensor.floor_divide
Tensor.floor_divide Tensor.fmod Tensor.fmod Tensor.frac Tensor.frac
Tensor.frexp Tensor.gather Tensor.gcd Tensor.gcd Tensor.ge Tensor.ge
Tensor.greater_equal Tensor.greater_equal Tensor.geometric Tensor.geqrf
Tensor.ger Tensor.get_device Tensor.gt Tensor.gt Tensor.greater
Tensor.greater Tensor.half Tensor.hardshrink Tensor.heaviside
Tensor.histc Tensor.histogram Tensor.hsplit Tensor.hypot Tensor.hypot
Tensor.i0 Tensor.i0 Tensor.igamma Tensor.igamma Tensor.igammac
Tensor.igammac Tensor.index_add Tensor.index_add Tensor.index_copy
Tensor.index_copy Tensor.index_fill Tensor.index_fill Tensor.index_put
Tensor.index_put Tensor.index_reduce Tensor.index_reduce
Tensor.index_select Tensor.indices Tensor.inner Tensor.int
Tensor.int_repr Tensor.inverse Tensor.isclose Tensor.isfinite
Tensor.isinf Tensor.isposinf Tensor.isneginf Tensor.isnan
Tensor.is_contiguous Tensor.is_complex Tensor.is_conj
Tensor.is_floating_point Tensor.is_inference Tensor.is_leaf
Tensor.is_pinned Tensor.is_set_to Tensor.is_shared Tensor.is_signed
Tensor.is_sparse Tensor.istft Tensor.isreal Tensor.item Tensor.kthvalue
Tensor.lcm Tensor.lcm Tensor.ldexp Tensor.ldexp Tensor.le Tensor.le
Tensor.less_equal Tensor.less_equal Tensor.lerp Tensor.lerp
Tensor.lgamma Tensor.lgamma Tensor.log Tensor.log Tensor.logdet
Tensor.log10 Tensor.log10 Tensor.log1p Tensor.log1p Tensor.log2
Tensor.log2 Tensor.log_normal Tensor.logaddexp Tensor.logaddexp2
Tensor.logsumexp Tensor.logical_and Tensor.logical_and
Tensor.logical_not Tensor.logical_not Tensor.logical_or
Tensor.logical_or Tensor.logical_xor Tensor.logical_xor Tensor.logit
Tensor.logit Tensor.long Tensor.lt Tensor.lt Tensor.less Tensor.less
Tensor.lu Tensor.lu_solve Tensor.as_subclass Tensor.map
Tensor.masked_scatter Tensor.masked_scatter Tensor.masked_fill
Tensor.masked_fill Tensor.masked_select Tensor.matmul
Tensor.matrix_power Tensor.matrix_exp Tensor.max Tensor.maximum
Tensor.mean Tensor.module_load Tensor.nanmean Tensor.median
Tensor.nanmedian Tensor.min Tensor.minimum Tensor.mm Tensor.smm
Tensor.mode Tensor.movedim Tensor.moveaxis Tensor.msort Tensor.mul
Tensor.mul Tensor.multiply Tensor.multiply Tensor.multinomial Tensor.mv
Tensor.mvlgamma Tensor.mvlgamma Tensor.nansum Tensor.narrow
Tensor.narrow_copy Tensor.ndimension Tensor.nan_to_num Tensor.nan_to_num
Tensor.ne Tensor.ne Tensor.not_equal Tensor.not_equal Tensor.neg
Tensor.neg Tensor.negative Tensor.negative Tensor.nelement
Tensor.nextafter Tensor.nextafter Tensor.nonzero Tensor.norm
Tensor.normal Tensor.numel Tensor.numpy Tensor.orgqr Tensor.ormqr
Tensor.outer Tensor.permute Tensor.pin_memory Tensor.pinverse
Tensor.polygamma Tensor.polygamma Tensor.positive Tensor.pow Tensor.pow
Tensor.prod Tensor.put Tensor.qr Tensor.qscheme Tensor.quantile
Tensor.nanquantile Tensor.q_scale Tensor.q_zero_point
Tensor.q_per_channel_scales Tensor.q_per_channel_zero_points
Tensor.q_per_channel_axis Tensor.rad2deg Tensor.random Tensor.ravel
Tensor.reciprocal Tensor.reciprocal Tensor.record_stream
Tensor.register_hook Tensor.register_post_accumulate_grad_hook
Tensor.remainder Tensor.remainder Tensor.renorm Tensor.renorm
Tensor.repeat Tensor.repeat_interleave Tensor.requires_grad
Tensor.requires_grad Tensor.reshape Tensor.reshape_as Tensor.resize
Tensor.resize_as Tensor.retain_grad Tensor.retains_grad Tensor.roll
Tensor.rot90 Tensor.round Tensor.round Tensor.rsqrt Tensor.rsqrt
Tensor.scatter Tensor.scatter Tensor.scatter_add Tensor.scatter_add
Tensor.scatter_reduce Tensor.scatter_reduce Tensor.select
Tensor.select_scatter Tensor.set Tensor.share_memory Tensor.short
Tensor.sigmoid Tensor.sigmoid Tensor.sign Tensor.sign Tensor.signbit
Tensor.sgn Tensor.sgn Tensor.sin Tensor.sin Tensor.sinc Tensor.sinc
Tensor.sinh Tensor.sinh Tensor.asinh Tensor.asinh Tensor.arcsinh
Tensor.arcsinh Tensor.shape Tensor.size Tensor.slogdet
Tensor.slice_scatter Tensor.softmax Tensor.sort Tensor.split
Tensor.sparse_mask Tensor.sparse_dim Tensor.sqrt Tensor.sqrt
Tensor.square Tensor.square Tensor.squeeze Tensor.squeeze Tensor.std
Tensor.stft Tensor.storage Tensor.untyped_storage Tensor.storage_offset
Tensor.storage_type Tensor.stride Tensor.sub Tensor.sub Tensor.subtract
Tensor.subtract Tensor.sum Tensor.sum_to_size Tensor.svd Tensor.swapaxes
Tensor.swapdims Tensor.t Tensor.t Tensor.tensor_split Tensor.tile
Tensor.to Tensor.to_mkldnn Tensor.take Tensor.take_along_dim Tensor.tan
Tensor.tan Tensor.tanh Tensor.tanh Tensor.atanh Tensor.atanh
Tensor.arctanh Tensor.arctanh Tensor.tolist Tensor.topk Tensor.to_dense
Tensor.to_sparse Tensor.to_sparse_csr Tensor.to_sparse_csc
Tensor.to_sparse_bsr Tensor.to_sparse_bsc Tensor.trace Tensor.transpose
Tensor.transpose Tensor.triangular_solve Tensor.tril Tensor.tril
Tensor.triu Tensor.triu Tensor.true_divide Tensor.true_divide
Tensor.trunc Tensor.trunc Tensor.type Tensor.type_as Tensor.unbind
Tensor.unflatten Tensor.unfold Tensor.uniform Tensor.unique
Tensor.unique_consecutive Tensor.unsqueeze Tensor.unsqueeze
Tensor.values Tensor.var Tensor.vdot Tensor.view Tensor.view_as
Tensor.vsplit Tensor.where Tensor.xlogy Tensor.xlogy Tensor.xpu
Tensor.zero
